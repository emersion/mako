image: alpine/latest
packages:
  - meson
  - wayland-dev
  - wayland-protocols
  - cairo-dev
  - pango-dev
  - gdk-pixbuf-dev
  - scdoc
  # required by basu
  - gperf
  - linux-headers
  - libcap-dev
sources:
  - https://github.com/emersion/mako
  - https://github.com/emersion/basu
tasks:
  - basu: |
      cd basu
      meson build/ --prefix=/usr
      ninja -C build/
      sudo ninja -C build/ install
  - setup: |
      cd mako
      meson build/ -Dauto_features=enabled -Dsd-bus-provider=basu -Dsystemd=disabled
  - build: |
      cd mako
      ninja -C build/
